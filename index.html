
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Karl's Code</title>
  <meta name="author" content="Karl Roberts">

  
  <meta name="description" content="I was thinking about AWS lambda&rsquo;s last night after a colleague asked how long they take to start? For those who don&rsquo;t know, an AWS Lambda &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://karlroberts.github.io/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Karl's Code" type="application/atom+xml">

  <!-- add scripts I want to add first if the keywords section in YML frontmatter exists -->


  
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<!-- custom style for morkdown tables -->
<link href="/stylesheets/table-data.css" media="screen, projection" rel="stylesheet" type="text/css" />





  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-72539490-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Karl's Code</a></h1>
  
    <h2>and other code related stuff</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="karlroberts.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/03/15/aws-lambda-musings/">AWS Lambda Musings - Launch Times</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-03-15T00:50:55+00:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>15</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>12:50 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I was thinking about AWS lambda&rsquo;s last night after a colleague asked how long they take to start?</p>

<p>For those who don&rsquo;t know, an AWS Lambda enables so-called &ldquo;Serverless&rdquo; event processing. On an &ldquo;event&rdquo; or &ldquo;request&rdquo; AWS will run your Lambda code function, and charge you just for the time it takes to run rather than paying for the time of a full EC2 instance running for hours. So if your application only need to sporadically answer requests it may be a good cost trade-off.</p>

<p>The down side is that your application becomes more fragmented, which can become an Operations and maintenance issue, and you are now definitely tied to your cloud provider. If you need super responsive queries you may be better to run a traditional application on EC2 that can be ready and listening and pay for its uptime.</p>

<p>Anyway back to my topic of AWS Lambda response times&hellip;</p>

<p><a href="https://aws.amazon.com/blogs/compute/container-reuse-in-lambda/">According to this link</a> they are run in &ldquo;containers&rdquo; I imagine that is similar to a docker container but a custom to AWS &ldquo;chroot&rdquo; jail?</p>

<p>If the container is still running from a previous invocation then there is no start up time for the container just the start-up time for the AWS lambda function.</p>

<p>Even if there is a container start-up time, if the underlying host is running (likely) then Docker containers are quick to start, like starting a process and a custom chroot jail may be quicker still. However some <a href="https://forums.aws.amazon.com/thread.jspa?threadID=226136">developer forums</a> have stated that they can get 50-100ms response times from their Lambda&rsquo;s but occasionally see significant 12-15 second delays for infrequent invocations.</p>

<p>One can only guess at the reason but some kind of provisioning or resource sharing bottleneck seems likely. No doubt AWS teams are working on this as &ldquo;Serverless&rdquo; compute becomes the new Cloud buzzword and battleground.</p>

<p>But, as I mentioned earlier, the true benefit of Serverless is cheaper running for request or event processing not blazingly fast performance and response times</p>

<h3>On another topic &hellip;</h3>

<p>AWS Lambda currently supports Lambdas written in <a href="https://aws.amazon.com/lambda/details/#Bring_Your_Own_Code">Java, Node.js, C#, and Python code</a> with more language support coming in the future.</p>

<p>I was thinking about how to run a very fast native function, e.g. compiled with Rust with no dynamically linked libs (all static) and found an <a href="http://julienblanchard.com/2015/rust-on-aws-lambda/">article showing how to launch the executable</a> even though it is not yet directly supported by AWS by wrapping it in a node.js lambda.</p>

<p>This got me thinking, is node the fastest way to do this, after all if I&rsquo;m a speed freak and writing Rust then launch times are important to me&hellip;</p>

<p>So I looked at at launching a process from node and python and timing it, I did not investigate C# or Java as they will always take longer to start because their runtime is doing more stuff.</p>

<p>This is not a statistically viable experiment (I only ran it once :-) but I built a shell tool called <a href="https://gist.github.com/karlroberts/141e1e7b38ca85ac3da7b88297d48a97">launch.sh</a>, see the <a href="https://gist.github.com/karlroberts/141e1e7b38ca85ac3da7b88297d48a97">gist</a>, to spit out a date including nanoseconds (my laptop supports this) then kick of a python app that uses a subprocess to run the same date command twice from within the python app. It then does the same using node.js.</p>

<p>Running it I get this data :-</p>

<pre><code>me@storm:~/bin$ ./launch.sh 
start launch python data subprocess...
09:57:25 1489532245 519378382
09:57:25 1489532245 530775400
09:57:25 1489532245 531650629

start launch python compiled data subprocess...
09:57:25 1489532245 533984993
09:57:25 1489532245 541690675
09:57:25 1489532245 542552837

Now using node v7.6.0 (npm v4.1.2)
start launch node subprocess
09:57:25 1489532245 712281203
09:57:25 1489532245 750742945
09:57:25 1489532245 751821095
</code></pre>

<p>The first date in each triplet is the date at the shell before launching python or node followed by the subprocess date commands inside the python or node script.</p>

<p>The last set of numbers on each line is nanoseconds.</p>

<p>I also pre-compiled a python script to see if it was faster than executing the script, but forgot that python would do a search for pre-compiled scripts version of commands so the results of the first two are probably actually running the compiled version, the first is slower to launch presumably searching to see if there is a pre-compiled version in the directory (N.B. this is a guess as I don&rsquo;t have enough data here to prove it). Regardless I removed the compiled python and ran again to get un-compiled time data:</p>

<pre><code>start launch python data subprocess...
10:34:30 1489534470 041312697
10:34:30 1489534470 054794071
10:34:30 1489534470 055933101
</code></pre>

<h5>The results are :-</h5>

<pre><code>Uncompiled python takes 13481374 ns to launch and run the subprocess
Uncompiled python takes  1139030 ns to launch and run a subprocess once it is already running

  Compiled python takes  7705682 ns to launch and run the subprocess
  Compiled python takes   862162 ns to launch and run a subprocess once it is already running 

node.js           takes 38461742 ns to launch and run the subprocess
node.js           takes  1078150 ns to launch and run a subprocess once it is already running 
</code></pre>

<p>So the results show it is currently best to use compiled python to kick off a sub process e.g. a Rust or Go procedure in AWS lambda</p>

<p>When Go or Rust are natively supported by AWS Lambda containers no doubt the story will change.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/03/14/double-your-speed-with-a-hardware-upgrade/">Don't Sacrifice Code Quality for Performance</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-03-14T07:30:32+00:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>7:30 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>As a developer I&rsquo;ve often seen (and been the culprit) of premature optimisation. Developers, in our desire to write fast software often, mistakenly, sacriface readability, maintainability and correctness in favour of speed.</p>

<blockquote><p>Premature optimization is the root of all evil ... in programming</p><footer><strong>Donuld Knuth</strong> <cite><a href='https://en.wikiquote.org/wiki/Donald_Knuth'>Computer Programming as an Art (1974)</a></cite></footer></blockquote>


</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2017/03/14/double-your-speed-with-a-hardware-upgrade/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/03/13/reverting-to-a-previous-kernel/">Reverting to a Previous Kernel</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-03-13T01:40:00+00:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>13</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>1:40 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I haven&rsquo;t needed to downgrade my kernel for a while. I was using Ubuntu&rsquo;s 14.04 LTS (long time support) support for a few years, and it was so stable that
I just run the following with no problems.</p>

<pre><code>sudo apt-get update
sudo apt-get upgrade
</code></pre>

<p>But recently I got a new laptop with the latest chipsets and peripherals and decided to upgrade to the new Ubuntu Xenial 16.04 LTS
while I&rsquo;m at it.</p>

<p>I&rsquo;m sad to say that the combination of new distro with bleeding edge hardware has twice given me a problem. </div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2017/03/13/reverting-to-a-previous-kernel/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/01/25/push-a-docker-image-to-personal-repository/">Push a Docker Image to a Personal Repository</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-01-25T02:30:53+00:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>25</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>2:30 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Why push your own image?</h2>

<p>After using docker for a while you may find that you want more control over the images you want to base your containers on.</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2017/01/25/push-a-docker-image-to-personal-repository/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2017/01/09/disabling-usb-ports-on-linux/">Disabling the Webcam or USB Ports on Linux</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2017-01-09T04:46:31+00:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>9</span><span class='date-suffix'>th</span>, <span class='date-year'>2017</span></span> <span class='time'>4:46 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>Why disable a USB port?</h2>

<p>You may just want to make sure that you webcam, usually connected to the internal USB bus, is turned off.</p>

<p>In my case my laptop webcam has become intermittently faulty. This has caused my laptop to hang on shutdown while the kernel tries to power down the device.</p>

<p>Clearly I want to disable the camera&rsquo;s port without disabling all the other USB ports on the laptop&hellip;</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2017/01/09/disabling-usb-ports-on-linux/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/01/18/octopress-ignores-published-false-gotcha/">Octopress Ignores Published: False - GOTCHA</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-01-18T03:29:13+00:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>18</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>3:29 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I recently had the misfortune that octopress started ignoring my <code>published: false</code> statement in my blogs YAML header section. I have now solved the issue. </div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/01/18/octopress-ignores-published-false-gotcha/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2016/01/14/using-javascript-in-octopress/">Using JavaScript in Octopress</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2016-01-14T00:24:02+00:00'><span class='date'><span class='date-month'>Jan</span> <span class='date-day'>14</span><span class='date-suffix'>th</span>, <span class='date-year'>2016</span></span> <span class='time'>12:24 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I intend to write a series of blogs on JavaScript. It occurred to me that the blog should be able to demonstrate the JS code to make it more accessible.
OK
So, first things first, I need to get Octopress (my blogging framework) to use my JavaScript.</p>

<p>This blog intends to catalogue how I got my JS examples into the blog. </div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2016/01/14/using-javascript-in-octopress/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/09/01/working-with-terraform-remote-statefile/">Working With Terraform Remote Statefile</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-09-01T01:04:11+00:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>1</span><span class='date-suffix'>st</span>, <span class='date-year'>2015</span></span> <span class='time'>1:04 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><h4>Remote state</h4>

<p>There are gotcha&rsquo;s when working with remote state in terraform that this blog attempts to explain and workaround. </div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2015/09/01/working-with-terraform-remote-statefile/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/08/26/using-aws-s3-for-intranets/">Private Websites in S3 Buckets</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-08-26T04:25:25+00:00'><span class='date'><span class='date-month'>Aug</span> <span class='date-day'>26</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>4:25 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Many people now realise that you can use Amazon Web Services (AWS) S3 buckets to <a href="http://docs.aws.amazon.com/AmazonS3/latest/dev/WebsiteHosting.html">host a static website</a>.</p>

<p>This is cool because it is very reliable and extremly cheap.
You don&rsquo;t pay to have an EC2 instance constantly running </div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2015/08/26/using-aws-s3-for-intranets/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/06/27/passwordless-ssh-on-synology/">Passwordless Ssh on Synology</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-06-27T07:43:13+00:00'><span class='date'><span class='date-month'>Jun</span> <span class='date-day'>27</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>7:43 am</span></time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I want the rsync user on my Synology box (called synology) to use ssh with no password. </div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2015/06/27/passwordless-ssh-on-synology/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/posts/2">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/03/15/aws-lambda-musings/">AWS Lambda Musings - Launch Times</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/03/14/double-your-speed-with-a-hardware-upgrade/">Don't Sacrifice Code Quality for Performance</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/03/13/reverting-to-a-previous-kernel/">Reverting to a Previous Kernel</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/01/25/push-a-docker-image-to-personal-repository/">Push a Docker Image to a Personal Repository</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/01/09/disabling-usb-ports-on-linux/">Disabling the Webcam or USB Ports on Linux</a>
      </li>
    
  </ul>
</section>
<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- karlcode1 -->
<ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-2688887005119521" data-ad-slot="6142720898"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});

</script>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'karlroberts',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- karlcode-leader1 -->
<ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-2688887005119521" data-ad-slot="4526386891"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- <p> adsense here todo... </p> -->
<p>
Copyright &copy; 2017 - Karl Roberts -
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'karlcode';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>







</body>
</html>
